<Module>
  <ModulePrefs title="getPreferences Test" height="40" author="Google" author_email="calendar-gadget-questions@google.com">
    <Require feature="google.calendar-0.5"/>
  </ModulePrefs>
  <Content type="html">
    <!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01//EN" "http://www.w3.org/TR/html4/strict.dtd">
    <html>
      <body>

        <script>
          function preferenceCallback(prefs) {

          // This is the timezone offset for this computer
          var timezone_offset = prefs['timezone_offset'];

          // The calendar container tries to determine if the computer's clock is
          // incorrect. And will tell us by how much.
          var current_time_offset = prefs['current_time_offset'];

          // The calendar container has a helper function to get the current time
          // which MATCHES the time that the container uses.
          var now = google.calendar.utils.getNow(current_time_offset);

          var out = 'Timezone Offset in milliseconds = ' + timezone_offset +
          '\nCalendar container thinks this computer\'s clock is off by = ' + current_time_offset + ' milliseconds\n' +
          'Current time = ' + now;
          alert(out);
          }

          // The gadget containers request that we do NOT run any JS inline.
          // Instead, register a callback handler.
          gadgets.util.registerOnLoadHandler(function() {
          google.calendar.getPreferences(preferenceCallback);
          });
        </script>

        Loading Preferences
      </body>
    </html>
  </Content>
</Module>
